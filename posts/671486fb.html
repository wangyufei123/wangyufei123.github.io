<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>MySQL学习笔记二 | 随笔小记</title>
  <meta name="description" content="MySQL学习笔记二1.分组查询1.1 添加分组签筛选作为条件的字段都来自于原始表单，可以将筛选条件放在where子句的后边 1.2 添加分组后筛选案例：查询那个部门的员工个数&gt;2作为条件的字段不是来自于原始的表单，需要使用having的关键字来筛选,需要放在group by关键字后边 1.3 函数分组group by子句后边还支持按照表达式或者函数进行分组案例：按照员工姓名长度分组，查询每">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL学习笔记二">
<meta property="og:url" content="http://lwblog.xyz/posts/671486fb.html">
<meta property="og:site_name" content="随笔小记">
<meta property="og:description" content="MySQL学习笔记二1.分组查询1.1 添加分组签筛选作为条件的字段都来自于原始表单，可以将筛选条件放在where子句的后边 1.2 添加分组后筛选案例：查询那个部门的员工个数&gt;2作为条件的字段不是来自于原始的表单，需要使用having的关键字来筛选,需要放在group by关键字后边 1.3 函数分组group by子句后边还支持按照表达式或者函数进行分组案例：按照员工姓名长度分组，查询每">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gh8ysht42tj30v00a2q5q.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gh90ilmfsvj312s0iedlk.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gh912codxhj312q0jk7cp.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gh916ckf3tj312m0j6tgz.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gh9ymnhf8fj30h206gaal.jpg">
<meta property="article:published_time" content="2020-08-17T01:04:45.000Z">
<meta property="article:modified_time" content="2020-08-17T01:07:00.875Z">
<meta property="article:author" content="Mr.Wang">
<meta property="article:tag" content="java 前端">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gh8ysht42tj30v00a2q5q.jpg">
  <!-- Canonical links -->
  <link rel="canonical" href="http://lwblog.xyz/posts/671486fb.html">
  
    <link rel="alternate" href="/atom.xml" title="随笔小记" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
    <link href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.css" rel="stylesheet">
  
  
<meta name="generator" content="Hexo 4.2.0"></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/wangyufei123" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpeg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">Mr.Wang</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Web Developer &amp; Designer</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> 北京, 中国</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">项目</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-books">
          <a href="/books">
            
            <i class="icon icon-book-fill"></i>
            
            <span class="menu-title">书单</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">友链</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/wangyufei123" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Mac/">Mac</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/google/">google</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mybatis/">mybatis</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/">学习计划</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%BB%9C%E5%9C%A8%E5%9C%A8%E7%BA%BF%E4%BC%A0%E8%BE%93%E5%B7%A5%E5%85%B7/">网络在在线传输工具</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JDK1-8/" rel="tag">JDK1.8</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/" rel="tag">Mac</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tampermonkey/" rel="tag">Tampermonkey</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/activiti6-0/" rel="tag">activiti6.0</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/google-diriver/" rel="tag">google diriver</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/" rel="tag">maven</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mybatis/" rel="tag">mybatis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oracle/" rel="tag">oracle</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlserver/" rel="tag">sqlserver</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A5%B6%E7%89%9B%E5%BF%AB%E4%BC%A0/" rel="tag">奶牛快传</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/" rel="tag">学习计划</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93/" rel="tag">文件传输</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B2%B9%E7%8C%B4/" rel="tag">油猴</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E5%9C%A8%E5%9C%A8%E7%BA%BF%E4%BC%A0%E8%BE%93%E5%B7%A5%E5%85%B7/" rel="tag">网络在在线传输工具</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B0%83%E8%AF%95/" rel="tag">调试</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/JDK1-8/" style="font-size: 13px;">JDK1.8</a> <a href="/tags/Mac/" style="font-size: 13px;">Mac</a> <a href="/tags/Tampermonkey/" style="font-size: 13px;">Tampermonkey</a> <a href="/tags/activiti6-0/" style="font-size: 13px;">activiti6.0</a> <a href="/tags/google-diriver/" style="font-size: 13px;">google diriver</a> <a href="/tags/java/" style="font-size: 13px;">java</a> <a href="/tags/maven/" style="font-size: 14px;">maven</a> <a href="/tags/mybatis/" style="font-size: 13px;">mybatis</a> <a href="/tags/oracle/" style="font-size: 13px;">oracle</a> <a href="/tags/sqlserver/" style="font-size: 13px;">sqlserver</a> <a href="/tags/%E5%A5%B6%E7%89%9B%E5%BF%AB%E4%BC%A0/" style="font-size: 13px;">奶牛快传</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/" style="font-size: 13px;">学习计划</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93/" style="font-size: 13px;">文件传输</a> <a href="/tags/%E6%B2%B9%E7%8C%B4/" style="font-size: 13px;">油猴</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E5%9C%A8%E5%9C%A8%E7%BA%BF%E4%BC%A0%E8%BE%93%E5%B7%A5%E5%85%B7/" style="font-size: 13px;">网络在在线传输工具</a> <a href="/tags/%E8%B0%83%E8%AF%95/" style="font-size: 13px;">调试</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">8</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/posts/undefined.html" class="title">Centos7下静默安装Oracle 11g</a>
              </p>
              <p class="item-date">
                <time datetime="2020-08-23T09:38:23.000Z" itemprop="datePublished">2020-08-23</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/posts/671486fb.html" class="title">MySQL学习笔记二</a>
              </p>
              <p class="item-date">
                <time datetime="2020-08-17T01:04:45.000Z" itemprop="datePublished">2020-08-17</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/posts/f2612c14.html" class="title">MySQL高级部分学习一</a>
              </p>
              <p class="item-date">
                <time datetime="2020-08-17T01:04:14.000Z" itemprop="datePublished">2020-08-17</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/posts/8d9f420d.html" class="title">MySQL数据库学习笔记.md</a>
              </p>
              <p class="item-date">
                <time datetime="2020-08-17T01:03:37.000Z" itemprop="datePublished">2020-08-17</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/posts/80aa353a.html" class="title">StartUML使用技巧.md</a>
              </p>
              <p class="item-date">
                <time datetime="2020-08-13T01:36:12.000Z" itemprop="datePublished">2020-08-13</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<main class="main" role="main">
  <div class="content">
  <article id="post-MySQL学习笔记二" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        <!--首页的文章标题会走到这个页面-->

  
    <h1 class="article-title" itemprop="name">
      MySQL学习笔记二
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/posts/671486fb.html" class="article-date">
	  <time datetime="2020-08-17T01:04:45.000Z" itemprop="datePublished">2020-08-17</time>
	</a>
</span>
        
        

        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>


        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/posts/671486fb.html#comments" class="article-comment-link">评论</a></span>
        
	
		<span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 7.7k(字)</span>
	
	
		<span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 32(分)</span>
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h1 id="MySQL学习笔记二"><a href="#MySQL学习笔记二" class="headerlink" title="MySQL学习笔记二"></a>MySQL学习笔记二</h1><h2 id="1-分组查询"><a href="#1-分组查询" class="headerlink" title="1.分组查询"></a>1.分组查询</h2><h3 id="1-1-添加分组签筛选"><a href="#1-1-添加分组签筛选" class="headerlink" title="1.1 添加分组签筛选"></a>1.1 添加分组签筛选</h3><p>作为条件的字段都来自于原始表单，可以将筛选条件放在where子句的后边</p>
<h3 id="1-2-添加分组后筛选"><a href="#1-2-添加分组后筛选" class="headerlink" title="1.2 添加分组后筛选"></a>1.2 添加分组后筛选</h3><p>案例：查询那个部门的员工个数&gt;2<br>作为条件的字段不是来自于原始的表单，需要使用<code>having</code>的关键字来筛选,需要放在<code>group by</code>关键字后边</p>
<h3 id="1-3-函数分组"><a href="#1-3-函数分组" class="headerlink" title="1.3 函数分组"></a>1.3 函数分组</h3><p><code>group by</code>子句后边还支持按照表达式或者函数进行分组<br>案例：按照员工姓名长度分组，查询每一组员工的个数，筛选员工个数&gt;5的有哪些</p>
<h3 id="1-4-按多个字段分组"><a href="#1-4-按多个字段分组" class="headerlink" title="1.4 按多个字段分组"></a>1.4 按多个字段分组</h3><p>案例：每个部门，每个工种的员工的平均工资</p>
<h3 id="1-5-添加排序"><a href="#1-5-添加排序" class="headerlink" title="1.5 添加排序"></a>1.5 添加排序</h3><p>分组查询也可以支持排序</p>
<h2 id="2-连接查询"><a href="#2-连接查询" class="headerlink" title="2. 连接查询"></a>2. 连接查询</h2><p>查询的字段来自于多个表单，需要用到连接查询</p>
<h3 id="2-1-笛卡尔乘积"><a href="#2-1-笛卡尔乘积" class="headerlink" title="2.1 笛卡尔乘积"></a>2.1 笛卡尔乘积</h3><p>现象：表1有m行，表2有n行，结果=m*n行<br>避免：添加有效的连接条件</p>
<h3 id="2-2-连接查询分类"><a href="#2-2-连接查询分类" class="headerlink" title="2.2 连接查询分类"></a>2.2 连接查询分类</h3><p>按照年代分类：sql92标准、sql99标准<br>按照功能分类：内连接、外连接、交叉连接</p>
<h3 id="2-3-等值连接介绍"><a href="#2-3-等值连接介绍" class="headerlink" title="2.3 等值连接介绍"></a>2.3 等值连接介绍</h3><p><strong><em>如果给表起了别名，就不能用原来的表名称去限定字段的</em></strong><br>特点：</p>
<ol>
<li>多表等值连接的结果为多表的交集部分</li>
<li>n表连接，至少需要n-1个连接条件</li>
<li>多表连接的顺序没有要求</li>
<li>一般需要为表起别名</li>
<li>可以搭配前面介绍的所有的字句使用<br>案例：查询女神和对应男神的名称</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select beauty.&#96;name&#96;,boys.boyNamefrom boys,beauty where beauty.boyfriend_id &#x3D; boys.id</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gh8ysht42tj30v00a2q5q.jpg" alt=""></p>
<h3 id="2-4-非等值连接"><a href="#2-4-非等值连接" class="headerlink" title="2.4 非等值连接"></a>2.4 非等值连接</h3><p>案例：查询员工工资和工资级别</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT salary,grade_level</span><br><span class="line">FROM employees e,job_grades g</span><br><span class="line">WHERE salary BETWEEN g.&#96;lowest_sal&#96; AND g.&#96;highest_sal&#96;</span><br><span class="line">AND g.&#96;grade_level&#96;&#x3D;&#39;A&#39;;</span><br></pre></td></tr></table></figure>
<h3 id="2-5-自连接"><a href="#2-5-自连接" class="headerlink" title="2.5 自连接"></a>2.5 自连接</h3><p>自己连接自己<br>案例：查询员工名称和上级员工名称</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT e.employee_id,e.last_name,m.employee_id,m.last_name</span><br><span class="line">FROM employees e,employees m</span><br><span class="line">WHERE e.&#96;manager_id&#96;&#x3D;m.&#96;employee_id&#96;;</span><br></pre></td></tr></table></figure>
<h2 id="3-sql99语法"><a href="#3-sql99语法" class="headerlink" title="3. sql99语法"></a>3. sql99语法</h2><h3 id="3-1-语法介绍"><a href="#3-1-语法介绍" class="headerlink" title="3.1 语法介绍"></a>3.1 语法介绍</h3><p>1999年新推出的sql标准<br>语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select 查询列表</span><br><span class="line">from 表1 【连接类型】</span><br><span class="line">join 表2 别名 on 连接条件</span><br><span class="line">【where 筛选条件】</span><br><span class="line">【group by 分组】</span><br><span class="line">【having 筛选条件】</span><br><span class="line">【order by 排序列表】</span><br></pre></td></tr></table></figure>
<h3 id="3-2-等值连接"><a href="#3-2-等值连接" class="headerlink" title="3.2 等值连接"></a>3.2 等值连接</h3><p><strong><em>表的位置是可以进行互换的</em></strong><br>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select 查询列表</span><br><span class="line">from 表1 别名</span><br><span class="line">inner join 表2 别名 on 连接条件</span><br></pre></td></tr></table></figure>

<p>案例1:查询员工名称和部门名称</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select last_name,department_name</span><br><span class="line">from employees e</span><br><span class="line">inner join departments d</span><br><span class="line">on e.department_id &#x3D; d.department_id</span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gh90ilmfsvj312s0iedlk.jpg" alt=""></p>
<p>案例2:查询员工名、部门名、工种名，并按部门名降序(三表连接)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 连接的表需要和前边有联系(有一定的联系)</span><br><span class="line">SELECT last_name,department_name,job_title</span><br><span class="line">FROM employees e</span><br><span class="line">INNER JOIN departments d ON e.&#96;department_id&#96;&#x3D;d.&#96;department_id&#96;</span><br><span class="line">INNER JOIN jobs j ON e.&#96;job_id&#96; &#x3D; j.&#96;job_id&#96;</span><br><span class="line">ORDER BY department_name DESC;</span><br></pre></td></tr></table></figure>
<h3 id="3-3-非等值连接"><a href="#3-3-非等值连接" class="headerlink" title="3.3 非等值连接"></a>3.3 非等值连接</h3><p>案例1:查询员工的工资级别</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT salary,grade_level</span><br><span class="line">FROM employees e</span><br><span class="line"> JOIN job_grades g</span><br><span class="line"> ON e.&#96;salary&#96; BETWEEN g.&#96;lowest_sal&#96; AND g.&#96;highest_sal&#96;;</span><br></pre></td></tr></table></figure>
<p>案例2:查询工资级别的个数&gt;20的个数，并且按工资级别降序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT COUNT(*),grade_level</span><br><span class="line">FROM employees e</span><br><span class="line"> JOIN job_grades g</span><br><span class="line"> ON e.&#96;salary&#96; BETWEEN g.&#96;lowest_sal&#96; AND g.&#96;highest_sal&#96;</span><br><span class="line"> GROUP BY grade_level</span><br><span class="line"> HAVING COUNT(*)&gt;20</span><br></pre></td></tr></table></figure>
<h3 id="3-4-自连接"><a href="#3-4-自连接" class="headerlink" title="3.4 自连接"></a>3.4 自连接</h3><p>案例1:查询员工的名字、上级的名字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT e.last_name,m.last_name</span><br><span class="line"> FROM employees e</span><br><span class="line"> JOIN employees m</span><br><span class="line"> ON e.&#96;manager_id&#96;&#x3D; m.&#96;employee_id&#96;;</span><br></pre></td></tr></table></figure>
<p>案例2:查询姓名中包含字符k的员工的名字、上级的名字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT e.last_name,m.last_name</span><br><span class="line">FROM employees e</span><br><span class="line">JOIN employees m</span><br><span class="line">ON e.&#96;manager_id&#96;&#x3D; m.&#96;employee_id&#96;</span><br><span class="line">WHERE e.&#96;last_name&#96; LIKE &#39;%k%&#39;;</span><br></pre></td></tr></table></figure>
<h3 id="3-5-左-右-外连接"><a href="#3-5-左-右-外连接" class="headerlink" title="3.5 左(右)外连接"></a>3.5 左(右)外连接</h3><p>应用场景:用于查询一个表中有，另一个表没有的记录<br>特点：</p>
<ol>
<li>外连接的查询结果为主表中的所有记录<ul>
<li>如果从表中有和它匹配的，则显示匹配的值</li>
<li>如果从表中没有和它匹配的，则显示null</li>
<li>外连接查询结果=内连接结果+主表中有而从表没有的记录</li>
</ul>
</li>
<li>左外连接，left join左边的是主表<ul>
<li>右外连接，right join右边的是主表</li>
</ul>
</li>
<li>左外和右外交换两个表的顺序，可以实现同样的效果</li>
<li>全外连接=内连接的结果+表1中有但表2没有的+表2中有但表1没有的</li>
</ol>
<p>案例1:查询哪个部门没有员工<br>左外：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT d.*,e.employee_id</span><br><span class="line"> FROM departments d</span><br><span class="line"> LEFT OUTER JOIN employees e</span><br><span class="line"> ON d.&#96;department_id&#96; &#x3D; e.&#96;department_id&#96;</span><br><span class="line"> WHERE e.&#96;employee_id&#96; IS NULL;</span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gh912codxhj312q0jk7cp.jpg" alt=""></p>
<p>右外：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT d.*,e.employee_id</span><br><span class="line"> FROM employees e</span><br><span class="line"> RIGHT OUTER JOIN departments d</span><br><span class="line"> ON d.&#96;department_id&#96; &#x3D; e.&#96;department_id&#96;</span><br><span class="line"> WHERE e.&#96;employee_id&#96; IS NULL;</span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gh916ckf3tj312m0j6tgz.jpg" alt=""></p>
<h3 id="3-6-全外连接"><a href="#3-6-全外连接" class="headerlink" title="3.6 全外连接"></a>3.6 全外连接</h3><p><strong><em>==mysql数据库不支持全外连接查询==</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">USE girls;</span><br><span class="line"> SELECT b.*,bo.*</span><br><span class="line"> FROM beauty b</span><br><span class="line"> FULL OUTER JOIN boys bo</span><br><span class="line"> ON b.&#96;boyfriend_id&#96; &#x3D; bo.id;</span><br></pre></td></tr></table></figure>
<h3 id="3-7-交叉连接"><a href="#3-7-交叉连接" class="headerlink" title="3.7 交叉连接"></a>3.7 交叉连接</h3><p>代表笛卡尔乘积</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT b.*,bo.*</span><br><span class="line"> FROM beauty b</span><br><span class="line"> CROSS JOIN boys bo;</span><br></pre></td></tr></table></figure>
<h2 id="4-子查询介绍"><a href="#4-子查询介绍" class="headerlink" title="4. 子查询介绍"></a>4. 子查询介绍</h2><p>含义：出现在其他语句中的select语句，称为子查询或内查询<br>    外部的查询语句，称为主查询或外查询<br>分类：</p>
<ol>
<li><p>按子查询出现的位置：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">select后面：</span><br><span class="line">		仅仅支持标量子查询</span><br><span class="line">	</span><br><span class="line">	from后面：</span><br><span class="line">		支持表子查询</span><br><span class="line">	where或having后面：★</span><br><span class="line">		标量子查询（单行） √</span><br><span class="line">		列子查询  （多行） √</span><br><span class="line">		</span><br><span class="line">		行子查询</span><br><span class="line">		</span><br><span class="line">	exists后面（相关子查询）</span><br><span class="line">		表子查询</span><br></pre></td></tr></table></figure></li>
<li><p>按结果集的行列数不同：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">标量子查询（结果集只有一行一列）</span><br><span class="line">列子查询（结果集只有一列多行）</span><br><span class="line">行子查询（结果集有一行多列）</span><br><span class="line">表子查询（结果集一般为多行多列）</span><br></pre></td></tr></table></figure>
<h3 id="4-1-where后面标量子查询"><a href="#4-1-where后面标量子查询" class="headerlink" title="4.1 where后面标量子查询"></a>4.1 where后面标量子查询</h3><p>位置是在<code>where</code>或者<code>having</code>的后面<br>1、标量子查询（单行子查询）<br>2、列子查询（多行子查询）<br>3、行子查询（多列多行）<br>特点:<br>①子查询放在小括号内<br>②子查询一般放在条件的右侧<br>③标量子查询，一般搭配着单行操作符使用:&gt; &lt; &gt;= &lt;= = &lt;&gt;<br>列子查询，一般搭配着多行操作符使用:in、any/some、all<br>④子查询的执行优先于主查询执行，主查询的条件用到了子查询的结果</p>
</li>
</ol>
<p>案例1:查询员工的信息，满足 salary&gt;①结果（标量子查询）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary&gt;(</span><br><span class="line"></span><br><span class="line">	SELECT salary</span><br><span class="line">	FROM employees</span><br><span class="line">	WHERE last_name &#x3D; &#39;Abel&#39;</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>案例2:返回job_id与141号员工相同，salary比143号员工多的员工 姓名，job_id 和工资</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">SELECT last_name,job_id,salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE job_id &#x3D; (</span><br><span class="line">	SELECT job_id</span><br><span class="line">	FROM employees</span><br><span class="line">	WHERE employee_id &#x3D; 141</span><br><span class="line">) AND salary&gt;(</span><br><span class="line">	SELECT salary</span><br><span class="line">	FROM employees</span><br><span class="line">	WHERE employee_id &#x3D; 143</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>案例3:查询最低工资大于50号部门最低工资的部门id和其最低工资</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT MIN(salary),department_id</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY department_id</span><br><span class="line">HAVING MIN(salary)&gt;(</span><br><span class="line">	SELECT  MIN(salary)</span><br><span class="line">	FROM employees</span><br><span class="line">	WHERE department_id &#x3D; 50</span><br></pre></td></tr></table></figure>
<h3 id="4-2-where后面的列子查询"><a href="#4-2-where后面的列子查询" class="headerlink" title="4.2 where后面的列子查询"></a>4.2 where后面的列子查询</h3><p>案例1:返回location_id是1400或1700的部门中的所有员工姓名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT last_name</span><br><span class="line">FROM employees</span><br><span class="line">WHERE department_id  &lt;&gt;ALL(</span><br><span class="line">	SELECT DISTINCT department_id</span><br><span class="line">	FROM departments</span><br><span class="line">	WHERE location_id IN(1400,1700)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>案例2:返回其它工种中比job_id为‘IT_PROG’工种任一工资低的员工的员工号、姓名、job_id 以及salary</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">SELECT last_name,employee_id,job_id,salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary&lt;ANY(</span><br><span class="line">	SELECT DISTINCT salary</span><br><span class="line">	FROM employees</span><br><span class="line">	WHERE job_id &#x3D; &#39;IT_PROG&#39;</span><br><span class="line"></span><br><span class="line">) AND job_id&lt;&gt;&#39;IT_PROG&#39;;</span><br><span class="line"></span><br><span class="line">#或</span><br><span class="line">SELECT last_name,employee_id,job_id,salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary&lt;(</span><br><span class="line">	SELECT MAX(salary)</span><br><span class="line">	FROM employees</span><br><span class="line">	WHERE job_id &#x3D; &#39;IT_PROG&#39;</span><br><span class="line"></span><br><span class="line">) AND job_id&lt;&gt;&#39;IT_PROG&#39;;</span><br></pre></td></tr></table></figure>
<p>案例3:返回其它部门中比job_id为‘IT_PROG’部门所有工资都低的员工   的员工号、姓名、job_id 以及salary</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">SELECT last_name,employee_id,job_id,salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary&lt;ALL(</span><br><span class="line">	SELECT DISTINCT salary</span><br><span class="line">	FROM employees</span><br><span class="line">	WHERE job_id &#x3D; &#39;IT_PROG&#39;</span><br><span class="line"></span><br><span class="line">) AND job_id&lt;&gt;&#39;IT_PROG&#39;;</span><br><span class="line"></span><br><span class="line">#或</span><br><span class="line"></span><br><span class="line">SELECT last_name,employee_id,job_id,salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary&lt;(</span><br><span class="line">	SELECT MIN( salary)</span><br><span class="line">	FROM employees</span><br><span class="line">	WHERE job_id &#x3D; &#39;IT_PROG&#39;</span><br><span class="line"></span><br><span class="line">) AND job_id&lt;&gt;&#39;IT_PROG&#39;;</span><br></pre></td></tr></table></figure>
<h3 id="4-3-where后面的行子查询"><a href="#4-3-where后面的行子查询" class="headerlink" title="4.3 where后面的行子查询"></a>4.3 where后面的行子查询</h3><p>案例：查询员工编号最小并且工资最高的员工信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM employees</span><br><span class="line">WHERE employee_id&#x3D;(</span><br><span class="line">	SELECT MIN(employee_id)</span><br><span class="line">	FROM employees</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">)AND salary&#x3D;(</span><br><span class="line">	SELECT MAX(salary)</span><br><span class="line">	FROM employees</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="4-4-select后面的子查询"><a href="#4-4-select后面的子查询" class="headerlink" title="4.4 select后面的子查询"></a>4.4 select后面的子查询</h3><p><strong><em>==仅仅支持标量子查询==</em></strong><br>案例：查询每个部门的员工个数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT d.*,(</span><br><span class="line"></span><br><span class="line">	SELECT COUNT(*)</span><br><span class="line">	FROM employees e</span><br><span class="line">	WHERE e.department_id &#x3D; d.&#96;department_id&#96;</span><br><span class="line"> ) 个数</span><br><span class="line"> FROM departments d;</span><br></pre></td></tr></table></figure>

<p>案例2：查询员工号=102的部门名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT (</span><br><span class="line">	SELECT department_name,e.department_id</span><br><span class="line">	FROM departments d</span><br><span class="line">	INNER JOIN employees e</span><br><span class="line">	ON d.department_id&#x3D;e.department_id</span><br><span class="line">	WHERE e.employee_id&#x3D;102</span><br><span class="line">	</span><br><span class="line">) 部门名;</span><br></pre></td></tr></table></figure>
<h3 id="4-5-from后面的子查询"><a href="#4-5-from后面的子查询" class="headerlink" title="4.5 from后面的子查询"></a>4.5 from后面的子查询</h3><p><strong><em>==将子查询结果充当一张表，要求必须起别名==</em></strong><br>案例：查询每个部门的平均工资的工资等级</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT  ag_dep.*,g.&#96;grade_level&#96;</span><br><span class="line">FROM (</span><br><span class="line">	SELECT AVG(salary) ag,department_id</span><br><span class="line">	FROM employees</span><br><span class="line">	GROUP BY department_id</span><br><span class="line">) ag_dep</span><br><span class="line">INNER JOIN job_grades g</span><br><span class="line">ON ag_dep.ag BETWEEN lowest_sal AND highest_sal;</span><br></pre></td></tr></table></figure>
<h3 id="4-6-exists后面的子查询"><a href="#4-6-exists后面的子查询" class="headerlink" title="4.6 exists后面的子查询"></a>4.6 exists后面的子查询</h3><p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exists(完整的查询语句)</span><br><span class="line">结果：1或0</span><br></pre></td></tr></table></figure>
<p>案例1：查询有员工的部门名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#in</span><br><span class="line">SELECT department_name</span><br><span class="line">FROM departments d</span><br><span class="line">WHERE d.&#96;department_id&#96; IN(</span><br><span class="line">	SELECT department_id</span><br><span class="line">	FROM employees</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">#exists</span><br><span class="line"></span><br><span class="line">SELECT department_name</span><br><span class="line">FROM departments d</span><br><span class="line">WHERE EXISTS(</span><br><span class="line">	SELECT *</span><br><span class="line">	FROM employees e</span><br><span class="line">	WHERE d.&#96;department_id&#96;&#x3D;e.&#96;department_id&#96;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>案例2：查询没有女朋友的男神信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#in</span><br><span class="line"></span><br><span class="line">SELECT bo.*</span><br><span class="line">FROM boys bo</span><br><span class="line">WHERE bo.id NOT IN(</span><br><span class="line">	SELECT boyfriend_id</span><br><span class="line">	FROM beauty</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">#exists</span><br><span class="line">SELECT bo.*</span><br><span class="line">FROM boys bo</span><br><span class="line">WHERE NOT EXISTS(</span><br><span class="line">	SELECT boyfriend_id</span><br><span class="line">	FROM beauty b</span><br><span class="line">	WHERE bo.&#96;id&#96;&#x3D;b.&#96;boyfriend_id&#96;</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="5-分页查询"><a href="#5-分页查询" class="headerlink" title="5. 分页查询"></a>5. 分页查询</h2><p>应用场景：当要显示的数据，一页显示不全，需要分页提交sql请求<br>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">select 查询列表</span><br><span class="line">	from 表</span><br><span class="line">	【join type join 表2</span><br><span class="line">	on 连接条件</span><br><span class="line">	where 筛选条件</span><br><span class="line">	group by 分组字段</span><br><span class="line">	having 分组后的筛选</span><br><span class="line">	order by 排序的字段】</span><br><span class="line">	limit 【offset,】size;</span><br><span class="line">	</span><br><span class="line">	offset要显示条目的起始索引（起始索引从0开始）</span><br><span class="line">	size 要显示的条目个数</span><br></pre></td></tr></table></figure>

<p>特点：<br>①limit语句放在查询语句的最后<br>    ②公式<br>    要显示的页数 page，每页的条目数size</p>
<pre><code>select 查询列表
from 表
limit (page-1)*size,size;</code></pre><h2 id="6-联合查询介绍"><a href="#6-联合查询介绍" class="headerlink" title="6.联合查询介绍"></a>6.联合查询介绍</h2><p>应用场景：要查询的结果来自多个表，且多个表没有直接的关系，但查询信息节本一样<br>union 联合 合并：将多条查询语句的结果合并成一个结果<br>案例：查询中国用户中男性的信息以及外国用户中年男性的用户信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 去掉重复的</span><br><span class="line">SELECT * FROM employees  WHERE email LIKE &#39;%a%&#39;</span><br><span class="line">UNION</span><br><span class="line">SELECT * FROM employees  WHERE department_id&gt;90;</span><br><span class="line"></span><br><span class="line">-- 包含重复项</span><br><span class="line">SELECT id,cname FROM t_ca WHERE csex&#x3D;&#39;男&#39;</span><br><span class="line">UNION ALL</span><br><span class="line">SELECT t_id,tname FROM t_ua WHERE tGender&#x3D;&#39;male&#39;;</span><br></pre></td></tr></table></figure>
<h2 id="7-联合查询特点"><a href="#7-联合查询特点" class="headerlink" title="7.联合查询特点"></a>7.联合查询特点</h2><p>特点：★<br>1、要求多条查询语句的查询列数是一致的！<br>2、要求多条查询语句的查询的每一列的类型和顺序最好一致<br>3、union关键字默认去重，如果使用union all 可以包含重复项</p>
<h2 id="8-插入语句"><a href="#8-插入语句" class="headerlink" title="8. 插入语句"></a>8. 插入语句</h2><h3 id="8-1-插入语句方式一"><a href="#8-1-插入语句方式一" class="headerlink" title="8.1 插入语句方式一"></a>8.1 插入语句方式一</h3><h3 id="8-2-插入语句方式二"><a href="#8-2-插入语句方式二" class="headerlink" title="8.2 插入语句方式二"></a>8.2 插入语句方式二</h3><h2 id="9-修改表单记录"><a href="#9-修改表单记录" class="headerlink" title="9.修改表单记录"></a>9.修改表单记录</h2><h3 id="9-1-修改单表记录"><a href="#9-1-修改单表记录" class="headerlink" title="9.1 修改单表记录"></a>9.1 修改单表记录</h3><h3 id="9-2-修改多表记录"><a href="#9-2-修改多表记录" class="headerlink" title="9.2 修改多表记录"></a>9.2 修改多表记录</h3><p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sql92语法：</span><br><span class="line">update 表1 别名,表2 别名</span><br><span class="line">set 列 &#x3D; 值</span><br><span class="line">where 连接条件 and 筛选条件</span><br><span class="line"></span><br><span class="line">sql99语法：</span><br><span class="line">update 表1 别名</span><br><span class="line">inner|left|right join 表2 别名</span><br><span class="line">on 连接条件</span><br><span class="line">set 列 &#x3D; 值</span><br><span class="line">where 筛选条件</span><br></pre></td></tr></table></figure>
<h2 id="10-删除语句介绍"><a href="#10-删除语句介绍" class="headerlink" title="10. 删除语句介绍"></a>10. 删除语句介绍</h2><h3 id="10-1-删除方式一"><a href="#10-1-删除方式一" class="headerlink" title="10.1 删除方式一"></a>10.1 删除方式一</h3><p>删除表单的整行记录，自增长列的值从断点开始<br>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from 表名 where 筛选条件</span><br></pre></td></tr></table></figure>
<h3 id="10-2-删除方式二"><a href="#10-2-删除方式二" class="headerlink" title="10.2 删除方式二"></a>10.2 删除方式二</h3><p>删除了整个表单的记录，不能添加where条件，自增长的值从1开始<br>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">truncate table 表名</span><br></pre></td></tr></table></figure>
<h2 id="11-DDL语言介绍"><a href="#11-DDL语言介绍" class="headerlink" title="11. DDL语言介绍"></a>11. DDL语言介绍</h2><p>创建： create<br>修改： alter<br>删除： drop</p>
<h3 id="11-1-库的管理"><a href="#11-1-库的管理" class="headerlink" title="11.1 库的管理"></a>11.1 库的管理</h3><p>案例:创建库Books</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE IF NOT EXISTS books ;</span><br></pre></td></tr></table></figure>
<p>案例2:库的修改</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RENAME DATABASE books TO 新库名;</span><br></pre></td></tr></table></figure>
<p>案例3:更改库的字符集</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER DATABASE books CHARACTER SET gbk;</span><br></pre></td></tr></table></figure>
<p>案例4:库的删除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP DATABASE IF EXISTS books;</span><br></pre></td></tr></table></figure>
<h3 id="11-2-表的创建"><a href="#11-2-表的创建" class="headerlink" title="11.2 表的创建"></a>11.2 表的创建</h3><p>语法:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table 表名(</span><br><span class="line">	列名 列的类型【(长度) 约束】,</span><br><span class="line">	列名 列的类型【(长度) 约束】,</span><br><span class="line">	列名 列的类型【(长度) 约束】,</span><br><span class="line">	...</span><br><span class="line">	列名 列的类型【(长度) 约束】</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>案例：创建表Book</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE book(</span><br><span class="line">	id INT,#编号</span><br><span class="line">	bName VARCHAR(20),#图书名</span><br><span class="line">	price DOUBLE,#价格</span><br><span class="line">	authorId  INT,#作者编号</span><br><span class="line">	publishDate DATETIME#出版日期</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>案例：创建表author</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE IF NOT EXISTS author(</span><br><span class="line">	id INT,</span><br><span class="line">	au_name VARCHAR(20),</span><br><span class="line">	nation VARCHAR(10)</span><br><span class="line">)</span><br><span class="line">DESC author;</span><br></pre></td></tr></table></figure>
<h3 id="11-3-表的修改"><a href="#11-3-表的修改" class="headerlink" title="11.3 表的修改"></a>11.3 表的修改</h3><p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add|drop|modify|change column 列名 【列类型 约束】;</span><br></pre></td></tr></table></figure>
<p>案例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#①修改列名</span><br><span class="line">ALTER TABLE book CHANGE COLUMN publishdate pubDate DATETIME;</span><br><span class="line">#②修改列的类型或约束</span><br><span class="line">ALTER TABLE book MODIFY COLUMN pubdate TIMESTAMP;</span><br><span class="line">#③添加新列</span><br><span class="line">ALTER TABLE author ADD COLUMN annual DOUBLE; </span><br><span class="line">#④删除列</span><br><span class="line">ALTER TABLE book_author DROP COLUMN  annual;</span><br><span class="line">#⑤修改表名</span><br><span class="line">ALTER TABLE author RENAME TO book_author;</span><br><span class="line">DESC book;</span><br></pre></td></tr></table></figure>
<h3 id="11-4-表的删除"><a href="#11-4-表的删除" class="headerlink" title="11.4 表的删除"></a>11.4 表的删除</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE IF EXISTS book_author;</span><br><span class="line">SHOW TABLES;</span><br></pre></td></tr></table></figure>
<h3 id="11-5-表的复制"><a href="#11-5-表的复制" class="headerlink" title="11.5 表的复制"></a>11.5 表的复制</h3><p>案例：仅仅复制表的结构</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE copy LIKE author;</span><br></pre></td></tr></table></figure>

<p>案例：复制表的结构+数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE copy2 </span><br><span class="line">SELECT * FROM author;</span><br></pre></td></tr></table></figure>

<p>案例：只复制部分数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE copy3</span><br><span class="line">SELECT id,au_name</span><br><span class="line">FROM author </span><br><span class="line">WHERE nation&#x3D;&#39;中国&#39;;</span><br></pre></td></tr></table></figure>

<p>案例：仅仅复制某些字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE copy4 </span><br><span class="line">SELECT id,au_name</span><br><span class="line">FROM author</span><br><span class="line">WHERE 0;</span><br></pre></td></tr></table></figure>
<h2 id="12-数据类型介绍"><a href="#12-数据类型介绍" class="headerlink" title="12. 数据类型介绍"></a>12. 数据类型介绍</h2><p>常见的数据类型<br>数值型：<br>    整型<br>    小数：<br>        定点数<br>        浮点数<br>字符型：<br>    较短的文本：char、varchar<br>    较长的文本：text、blob（较长的二进制数据）</p>
<p>日期型：</p>
<h3 id="12-1-整型"><a href="#12-1-整型" class="headerlink" title="12.1 整型"></a>12.1 整型</h3><p>分类：<br>tinyint、smallint、mediumint、int/integer、bigint<br>   1          2             3              4       8</p>
<p>特点：<br>① 如果不设置无符号还是有符号，默认是有符号，如果想设置无符号，需要添加unsigned关键字<br>② 如果插入的数值超出了整型的范围,会报out of range异常，并且插入临界值<br>③ 如果不设置长度，会有默认的长度<br>长度代表了显示的最大宽度，如果不够会用0在左边填充，但必须搭配zerofill使用！</p>
<h3 id="12-2-浮点型"><a href="#12-2-浮点型" class="headerlink" title="12.2 浮点型"></a>12.2 浮点型</h3><p>分类：<br>1.浮点型<br>float(M,D)<br>double(M,D)<br>2.定点型<br>dec(M，D)<br>decimal(M,D)<br>特点：<br>①M：整数部位+小数部位 D：小数部位 如果超过范围，则插入临界值<br>②M和D都可以省略，如果是decimal，则M默认为10，D默认为0，如果是float和double，则会根据插入的数值的精度来决定精度<br>③定点型的精确度较高，如果要求插入数值的精度较高如货币运算等则考虑使用</p>
<h3 id="12-3-字符型"><a href="#12-3-字符型" class="headerlink" title="12.3 字符型"></a>12.3 字符型</h3><p>较短的文本：char、varchar<br>其他：<br>binary和varbinary用于保存较短的二进制<br>enum用于保存枚举<br>set用于保存集合<br>较长的文本：text、blob(较大的二进制)</p>
<h3 id="12-4-日期型"><a href="#12-4-日期型" class="headerlink" title="12.4 日期型"></a>12.4 日期型</h3><p>分类：<br>date只保存日期<br>time 只保存时间<br>year只保存年<br>datetime保存日期+时间<br>timestamp保存日期+时间</p>
<h2 id="13-常见约束介绍"><a href="#13-常见约束介绍" class="headerlink" title="13. 常见约束介绍"></a>13. 常见约束介绍</h2><p>not null:非空约束，用于保证该字段的值不能为空<br>DEFAULT：默认约束,用于保证该字段有默认值<br>PRIMARY KEY：主键约束，保证该字段的值具有唯一性，并且非空<br>UNIQUE：唯一约束，用于保证该字段的值具有唯一性，可以为空<br>CHECK：检查约束【mysql中不支持】<br>FOREIGN KEY：外键，用于限制两个表的关系，用于保证该字段的值必须来自于主表的关联列的值在从表添加外键约束，用于引用主表中某列的值</p>
<h3 id="13-1-创建表时添加列级约束"><a href="#13-1-创建表时添加列级约束" class="headerlink" title="13.1 创建表时添加列级约束"></a>13.1 创建表时添加列级约束</h3><p>直接在字段名和类型后面追加 约束类型即可。<br>只支持：默认、非空、主键、唯一</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE students;</span><br><span class="line">DROP TABLE stuinfo;</span><br><span class="line">CREATE TABLE stuinfo(</span><br><span class="line">	id INT PRIMARY KEY,#主键</span><br><span class="line">	stuName VARCHAR(20) NOT NULL UNIQUE,#非空</span><br><span class="line">	gender CHAR(1) CHECK(gender&#x3D;&#39;男&#39; OR gender &#x3D;&#39;女&#39;),#检查</span><br><span class="line">	seat INT UNIQUE,#唯一</span><br><span class="line">	age INT DEFAULT  18,#默认约束</span><br><span class="line">	majorId INT REFERENCES major(id)#外键</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="13-2-创建表时添加表级约束"><a href="#13-2-创建表时添加表级约束" class="headerlink" title="13.2 创建表时添加表级约束"></a>13.2 创建表时添加表级约束</h3><p>语法：在各个字段的最下面<br> 【constraint 约束名】 约束类型(字段名) </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE IF EXISTS stuinfo;</span><br><span class="line">CREATE TABLE stuinfo(</span><br><span class="line">	id INT,</span><br><span class="line">	stuname VARCHAR(20),</span><br><span class="line">	gender CHAR(1),</span><br><span class="line">	seat INT,</span><br><span class="line">	age INT,</span><br><span class="line">	majorid INT,</span><br><span class="line">	</span><br><span class="line">	CONSTRAINT pk PRIMARY KEY(id),#主键</span><br><span class="line">	CONSTRAINT uq UNIQUE(seat),#唯一键</span><br><span class="line">	CONSTRAINT ck CHECK(gender &#x3D;&#39;男&#39; OR gender  &#x3D; &#39;女&#39;),#检查</span><br><span class="line">	CONSTRAINT fk_stuinfo_major FOREIGN KEY(majorid) REFERENCES major(id)#外键</span><br><span class="line">	</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#通用的写法：★</span><br><span class="line"></span><br><span class="line">CREATE TABLE IF NOT EXISTS stuinfo(</span><br><span class="line">	id INT PRIMARY KEY,</span><br><span class="line">	stuname VARCHAR(20),</span><br><span class="line">	sex CHAR(1),</span><br><span class="line">	age INT DEFAULT 18,</span><br><span class="line">	seat INT UNIQUE,</span><br><span class="line">	majorid INT,</span><br><span class="line">	CONSTRAINT fk_stuinfo_major FOREIGN KEY(majorid) REFERENCES major(id)</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="13-3-主键和唯一的区别"><a href="#13-3-主键和唯一的区别" class="headerlink" title="13.3 主键和唯一的区别"></a>13.3 主键和唯一的区别</h3><h3 id="13-4-外键的特点"><a href="#13-4-外键的特点" class="headerlink" title="13.4 外键的特点"></a>13.4 外键的特点</h3><h3 id="13-5-修改表时添加约束"><a href="#13-5-修改表时添加约束" class="headerlink" title="13.5 修改表时添加约束"></a>13.5 修改表时添加约束</h3><p>1、添加列级约束<br>alter table 表名 modify column 字段名 字段类型 新约束;<br>2、添加表级约束<br>alter table 表名 add 【constraint 约束名】 约束类型(字段名) 【外键的引用】;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#1.添加非空约束</span><br><span class="line">ALTER TABLE stuinfo MODIFY COLUMN stuname VARCHAR(20)  NOT NULL;</span><br><span class="line">#2.添加默认约束</span><br><span class="line">ALTER TABLE stuinfo MODIFY COLUMN age INT DEFAULT 18;</span><br><span class="line">#3.添加主键</span><br><span class="line">#①列级约束</span><br><span class="line">ALTER TABLE stuinfo MODIFY COLUMN id INT PRIMARY KEY;</span><br><span class="line">#②表级约束</span><br><span class="line">ALTER TABLE stuinfo ADD PRIMARY KEY(id);</span><br><span class="line">#4.添加唯一</span><br><span class="line">#①列级约束</span><br><span class="line">ALTER TABLE stuinfo MODIFY COLUMN seat INT UNIQUE;</span><br><span class="line">#②表级约束</span><br><span class="line">ALTER TABLE stuinfo ADD UNIQUE(seat);</span><br><span class="line">#5.添加外键</span><br><span class="line">ALTER TABLE stuinfo ADD CONSTRAINT fk_stuinfo_major FOREIGN KEY(majorid) REFERENCES major(id);</span><br></pre></td></tr></table></figure>
<h3 id="13-6-修改表时去掉约束"><a href="#13-6-修改表时去掉约束" class="headerlink" title="13.6 修改表时去掉约束"></a>13.6 修改表时去掉约束</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#1.删除非空约束</span><br><span class="line">ALTER TABLE stuinfo MODIFY COLUMN stuname VARCHAR(20) NULL;</span><br><span class="line">#2.删除默认约束</span><br><span class="line">ALTER TABLE stuinfo MODIFY COLUMN age INT ;</span><br><span class="line">#3.删除主键</span><br><span class="line">ALTER TABLE stuinfo DROP PRIMARY KEY;</span><br><span class="line">#4.删除唯一</span><br><span class="line">ALTER TABLE stuinfo DROP INDEX seat;</span><br><span class="line">#5.删除外键</span><br><span class="line">ALTER TABLE stuinfo DROP FOREIGN KEY fk_stuinfo_major;</span><br></pre></td></tr></table></figure>
<h2 id="14-标识列"><a href="#14-标识列" class="headerlink" title="14. 标识列"></a>14. 标识列</h2><p>又称为自增长列<br>含义：可以不用手动的插入值，系统提供默认的序列值</p>
<p>特点：<br>1、标识列必须和主键搭配吗？不一定，但要求是一个key<br>2、一个表可以有几个标识列？至多一个！<br>3、标识列的类型只能是数值型<br>4、标识列可以通过 SET auto_increment_increment=3;设置步长<br>可以通过 手动插入值，设置起始值</p>
<h2 id="15-事务介绍"><a href="#15-事务介绍" class="headerlink" title="15. 事务介绍"></a>15. 事务介绍</h2><p>Transaction Control Language 事务控制语言<br>一个或一组sql语句组成一个执行单元，这个执行单元要么全部执行，要么全部不执行。<br>事务的特性：<br>ACID<br>原子性：一个事务不可再分割，要么都执行要么都不执行<br>一致性：一个事务执行会使数据从一个一致状态切换到另外一个一致状态<br>隔离性：一个事务的执行不受其他事务的干扰<br>持久性：一个事务一旦提交，则会永久的改变数据库的数据.</p>
<p>事务的创建<br>隐式事务：事务没有明显的开启和结束的标记<br>比如insert、update、delete语句</p>
<p>delete from 表 where id =1;</p>
<p>显式事务：事务具有明显的开启和结束的标记<br>前提：必须先设置自动提交功能为禁用</p>
<p>set autocommit=0;</p>
<p>步骤1：开启事务<br>set autocommit=0;<br>start transaction;可选的<br>步骤2：编写事务中的sql语句(select insert update delete)<br>语句1;<br>语句2;<br>…</p>
<p>步骤3：结束事务<br>commit;提交事务<br>rollback;回滚事务</p>
<p>savepoint 节点名;设置保存点</p>
<h3 id="15-1-事务的隔离"><a href="#15-1-事务的隔离" class="headerlink" title="15.1 事务的隔离"></a>15.1 事务的隔离</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gh9ymnhf8fj30h206gaal.jpg" alt="">  </p>
<h3 id="15-2-回滚"><a href="#15-2-回滚" class="headerlink" title="15.2 回滚"></a>15.2 回滚</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#1.演示事务的使用步骤</span><br><span class="line"></span><br><span class="line">#开启事务</span><br><span class="line">SET autocommit&#x3D;0;</span><br><span class="line">START TRANSACTION;</span><br><span class="line">#编写一组事务的语句</span><br><span class="line">UPDATE account SET balance &#x3D; 1000 WHERE username&#x3D;&#39;张无忌&#39;;</span><br><span class="line">UPDATE account SET balance &#x3D; 1000 WHERE username&#x3D;&#39;赵敏&#39;;</span><br><span class="line"></span><br><span class="line">#结束事务</span><br><span class="line">ROLLBACK;</span><br><span class="line">#commit;</span><br><span class="line"></span><br><span class="line">SELECT * FROM account;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.演示事务对于delete和truncate的处理的区别</span><br><span class="line"></span><br><span class="line">SET autocommit&#x3D;0;</span><br><span class="line">START TRANSACTION;</span><br><span class="line"></span><br><span class="line">DELETE FROM account;</span><br><span class="line">ROLLBACK;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#3.演示savepoint 的使用</span><br><span class="line">SET autocommit&#x3D;0;</span><br><span class="line">START TRANSACTION;</span><br><span class="line">DELETE FROM account WHERE id&#x3D;25;</span><br><span class="line">SAVEPOINT a;#设置保存点</span><br><span class="line">DELETE FROM account WHERE id&#x3D;28;</span><br><span class="line">ROLLBACK TO a;#回滚到保存点</span><br></pre></td></tr></table></figure>
<h2 id="16-视图介绍"><a href="#16-视图介绍" class="headerlink" title="16. 视图介绍"></a>16. 视图介绍</h2><p>含义：虚拟表，和普通的表一样使用</p>
<h3 id="16-1-视图创建"><a href="#16-1-视图创建" class="headerlink" title="16.1 视图创建"></a>16.1 视图创建</h3><p>语法：<br>create view 视图名<br>as<br>查询语句;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW myv1</span><br><span class="line">AS</span><br><span class="line">SELECT last_name,department_name,job_title</span><br><span class="line">FROM employees e</span><br><span class="line">JOIN departments d ON e.department_id  &#x3D; d.department_id</span><br><span class="line">JOIN jobs j ON j.job_id  &#x3D; e.job_id;</span><br></pre></td></tr></table></figure>
<h3 id="16-2-视图修改"><a href="#16-2-视图修改" class="headerlink" title="16.2 视图修改"></a>16.2 视图修改</h3><p>方式一：<br>create or replace view  视图名<br>as<br>查询语句;</p>
<p>方式二：<br>语法：<br>alter view 视图名<br>as<br>查询语句;</p>
<h3 id="16-3-视图查看和删除"><a href="#16-3-视图查看和删除" class="headerlink" title="16.3 视图查看和删除"></a>16.3 视图查看和删除</h3><p>删除视图：语法：drop view 视图名,视图名,…;<br>查看视图：DESC myv3;SHOW CREATE VIEW myv3;</p>
<h3 id="16-4-视图更新"><a href="#16-4-视图更新" class="headerlink" title="16.4 视图更新"></a>16.4 视图更新</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE VIEW myv1</span><br><span class="line">AS</span><br><span class="line">SELECT last_name,email,salary*12*(1+IFNULL(commission_pct,0)) &quot;annual salary&quot;</span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE VIEW myv1</span><br><span class="line">AS</span><br><span class="line">SELECT last_name,email</span><br><span class="line">FROM employees;</span><br></pre></td></tr></table></figure>

<p>具备以下特点的视图不允许更新：<br>1.含以下关键字的sql语句：分组函数、distinct、group  by、having、union或者union all<br>2.常量视图<br>3.Select中包含子查询<br>4.join<br>5.from一个不能更新的视图<br>6.where子句的子查询引用了from子句中的表</p>
<h2 id="17-函数和存储过程"><a href="#17-函数和存储过程" class="headerlink" title="17. 函数和存储过程"></a>17. 函数和存储过程</h2><p>说明：变量由系统定义，不是用户定义，属于服务器层面<br>注意：全局变量需要添加global关键字，会话变量需要添加session关键字，如果不写，默认会话级别<br>使用步骤：<br>1、查看所有系统变量<br>show global|【session】variables;<br>2、查看满足条件的部分系统变量<br>show global|【session】 variables like ‘%char%’;<br>3、查看指定的系统变量的值<br>select @@global|【session】系统变量名;<br>4、为某个系统变量赋值<br>方式一：<br>set global|【session】系统变量名=值;<br>方式二：<br>set @@global|【session】系统变量名=值;</p>
<h3 id="17-1-全局变量"><a href="#17-1-全局变量" class="headerlink" title="17.1 全局变量"></a>17.1 全局变量</h3><p>作用域：针对于所有会话（连接）有效，但不能跨重启</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#①查看所有全局变量</span><br><span class="line">SHOW GLOBAL VARIABLES;</span><br><span class="line">#②查看满足条件的部分系统变量</span><br><span class="line">SHOW GLOBAL VARIABLES LIKE &#39;%char%&#39;;</span><br><span class="line">#③查看指定的系统变量的值</span><br><span class="line">SELECT @@global.autocommit;</span><br><span class="line">#④为某个系统变量赋值</span><br><span class="line">SET @@global.autocommit&#x3D;0;</span><br><span class="line">SET GLOBAL autocommit&#x3D;0;</span><br></pre></td></tr></table></figure>
<h3 id="17-2-会话变量"><a href="#17-2-会话变量" class="headerlink" title="17.2 会话变量"></a>17.2 会话变量</h3><p>作用域：针对于当前会话（连接）有效</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#①查看所有会话变量</span><br><span class="line">SHOW SESSION VARIABLES;</span><br><span class="line">#②查看满足条件的部分会话变量</span><br><span class="line">SHOW SESSION VARIABLES LIKE &#39;%char%&#39;;</span><br><span class="line">#③查看指定的会话变量的值</span><br><span class="line">SELECT @@autocommit;</span><br><span class="line">SELECT @@session.tx_isolation;</span><br><span class="line">#④为某个会话变量赋值</span><br><span class="line">SET @@session.tx_isolation&#x3D;&#39;read-uncommitted&#39;;</span><br><span class="line">SET SESSION tx_isolation&#x3D;&#39;read-committed&#39;;</span><br></pre></td></tr></table></figure>
<h3 id="17-3-自定义变量-用户变量"><a href="#17-3-自定义变量-用户变量" class="headerlink" title="17.3 自定义变量-用户变量"></a>17.3 自定义变量-用户变量</h3><p>说明：变量由用户自定义，而不是系统提供的<br>使用步骤：<br>1、声明<br>2、赋值<br>3、使用（查看、比较、运算等）<br>作用域：针对于当前会话（连接）有效，作用域同于会话变量</p>
<p>赋值操作符：=或:=<br>①声明并初始化<br>SET @变量名=值;<br>SET @变量名:=值;<br>SELECT @变量名:=值;</p>
<p>②赋值（更新变量的值）<br>方式一：<br>    SET @变量名=值;<br>    SET @变量名:=值;<br>    SELECT @变量名:=值;<br>方式二：<br>    SELECT 字段 INTO @变量名<br>    FROM 表;<br>③使用（查看变量的值）<br>SELECT @变量名;</p>
<h3 id="17-4-自定义变量-局部变量"><a href="#17-4-自定义变量-局部变量" class="headerlink" title="17.4 自定义变量-局部变量"></a>17.4 自定义变量-局部变量</h3><p>作用域：仅仅在定义它的begin end块中有效<br>应用在 begin end中的第一句话</p>
<p>①声明<br>DECLARE 变量名 类型;<br>DECLARE 变量名 类型 【DEFAULT 值】;</p>
<p>②赋值（更新变量的值）<br>方式一：<br>    SET 局部变量名=值;<br>    SET 局部变量名:=值;<br>    SELECT 局部变量名:=值;<br>方式二：<br>    SELECT 字段 INTO 具备变量名<br>    FROM 表;<br>③使用（查看变量的值）<br>SELECT 局部变量名;</p>
<p>案例：声明两个变量，求和并打印</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#用户变量</span><br><span class="line">SET @m&#x3D;1;</span><br><span class="line">SET @n&#x3D;1;</span><br><span class="line">SET @sum&#x3D;@m+@n;</span><br><span class="line">SELECT @sum;</span><br><span class="line"></span><br><span class="line">#局部变量</span><br><span class="line">DECLARE m INT DEFAULT 1;</span><br><span class="line">DECLARE n INT DEFAULT 1;</span><br><span class="line">DECLARE SUM INT;</span><br><span class="line">SET SUM&#x3D;m+n;</span><br><span class="line">SELECT SUM;</span><br></pre></td></tr></table></figure>
<h3 id="17-5-存储过程介绍"><a href="#17-5-存储过程介绍" class="headerlink" title="17.5 存储过程介绍"></a>17.5 存储过程介绍</h3><p>含义：一组预先编译好的SQL语句的集合，理解成批处理语句<br>1、提高代码的重用性<br>2、简化操作<br>3、减少了编译次数并且减少了和数据库服务器的连接次数，提高了效率</p>
<h3 id="17-6-存储过程语法"><a href="#17-6-存储过程语法" class="headerlink" title="17.6 存储过程语法"></a>17.6 存储过程语法</h3><ol>
<li>创建语法 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE 存储过程名(参数列表)</span><br><span class="line">BEGIN</span><br><span class="line"></span><br><span class="line">	存储过程体（一组合法的SQL语句）</span><br><span class="line">END</span><br><span class="line"> ⚠️</span><br><span class="line"> 1.参数列表包含三部分: in stuname varchar(20)</span><br><span class="line">    参数模式：</span><br><span class="line">        in:该参数可以作为输入，也就是该参数需要调用方传入值</span><br><span class="line">        out:该参数可以作为输出，也就是该参数可以作为返回值</span><br><span class="line">        inout:该参数既可以作为输入又可以作为输出，也就是该参数既需要传入值，又              可以返回值</span><br><span class="line">    参数名：</span><br><span class="line">    参数类型：</span><br><span class="line"> 2.如果存储过程体仅仅只有一句话，begin end可以省略</span><br><span class="line"> 3.存储过程体中的每条sql语句的结尾要求必须加分号</span><br><span class="line"> 4.存储过程的结尾可以使用 delimiter 重新设置</span><br><span class="line">    语法：</span><br><span class="line">        delimiter 结束标记</span><br><span class="line">    案例：</span><br><span class="line">        delimiter $</span><br></pre></td></tr></table></figure></li>
<li>调用方法<br> CALL 存储过程名(实参列表);</li>
</ol>
<h3 id="17-7-空参的存储过程"><a href="#17-7-空参的存储过程" class="headerlink" title="17.7 空参的存储过程"></a>17.7 空参的存储过程</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 定义存储过程</span><br><span class="line">delimiter $</span><br><span class="line">create  PROCEDURE myp2()</span><br><span class="line">begin</span><br><span class="line">	insert into admin(username,&#96;password&#96;) values(&#39;测试&#39;,&#39;12345&#39;);</span><br><span class="line">end $</span><br><span class="line"></span><br><span class="line">call myp2()$</span><br></pre></td></tr></table></figure>
<h3 id="17-8-带in模式的存储过程"><a href="#17-8-带in模式的存储过程" class="headerlink" title="17.8 带in模式的存储过程"></a>17.8 带in模式的存储过程</h3><p>案例1：创建存储过程实现 根据女神名，查询对应的男神信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">create PROCEDURE myp3(in beatyName VARCHAR(20))</span><br><span class="line">begin</span><br><span class="line">	select be.*,bo.*</span><br><span class="line">	from beauty be</span><br><span class="line">	left join boys bo on be.boyfriend_id &#x3D; bo.id</span><br><span class="line">	where be.name &#x3D; beatyName;</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">call myp3(&#39;柳岩&#39;)</span><br></pre></td></tr></table></figure>

<p>案例2 ：创建存储过程实现，用户是否登录成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">create PROCEDURE myp4(in username VARCHAR(20),in password VARCHAR(20))</span><br><span class="line">begin</span><br><span class="line">	DECLARE result VARCHAR(20) DEFAULT &#39;&#39;; #  声明并初始化</span><br><span class="line">	select count(*) into result # 赋值</span><br><span class="line">	from admin</span><br><span class="line">	where admin.username &#x3D; username</span><br><span class="line">	and admin.password &#x3D; password;</span><br><span class="line">	</span><br><span class="line">	select result; # 使用</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">call myp4(&#39;ceshi&#39;,&#39;123&#39;)</span><br></pre></td></tr></table></figure>
<h3 id="17-9-带out模式的存储过程"><a href="#17-9-带out模式的存储过程" class="headerlink" title="17.9 带out模式的存储过程"></a>17.9 带out模式的存储过程</h3><p>案例1：根据输入的女神名，返回对应的男神名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE myp6(IN beautyName VARCHAR(20),OUT boyName VARCHAR(20))</span><br><span class="line">BEGIN</span><br><span class="line">	SELECT bo.boyname INTO boyname</span><br><span class="line">	FROM boys bo</span><br><span class="line">	RIGHT JOIN</span><br><span class="line">	beauty b ON b.boyfriend_id &#x3D; bo.id</span><br><span class="line">	WHERE b.name&#x3D;beautyName ;</span><br><span class="line">	</span><br><span class="line">END $</span><br></pre></td></tr></table></figure>
<p>案例2：根据输入的女神名，返回对应的男神名和魅力值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">create PROCEDURE myp8(in beatyName varchar(20),out boyName varchar(20),out usercp int)</span><br><span class="line">BEGIN</span><br><span class="line">	select bo.boyName ,bo.userCP into boyName ,usercp</span><br><span class="line">	from boys bo</span><br><span class="line">	inner join beauty b on bo.id &#x3D; b.boyfriend_id</span><br><span class="line">	where b.name &#x3D; beatyName;</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">call myp8(&#39;小昭&#39;,@bName,@cp)</span><br><span class="line"></span><br><span class="line">select @bName,@cp</span><br></pre></td></tr></table></figure>
<h3 id="17-10-带inout模式的存储过程"><a href="#17-10-带inout模式的存储过程" class="headerlink" title="17.10 带inout模式的存储过程"></a>17.10 带inout模式的存储过程</h3><p>案例1：传入a和b两个值，最终a和b都翻倍并返回</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create PROCEDURE myp9(inout a int,inout b int)</span><br><span class="line">BEGIN</span><br><span class="line">	set a &#x3D; a * 2;</span><br><span class="line">	set b &#x3D;b * 2;</span><br><span class="line">END</span><br><span class="line"># 调用</span><br><span class="line">set @n&#x3D;8;</span><br><span class="line">set @m&#x3D;10;</span><br><span class="line">call myp9(@n,@m);</span><br><span class="line">select @m,@n</span><br></pre></td></tr></table></figure>
<h3 id="17-11-存储过程的删除"><a href="#17-11-存储过程的删除" class="headerlink" title="17.11 存储过程的删除"></a>17.11 存储过程的删除</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">语法：drop procedure 存储过程名</span><br><span class="line">DROP PROCEDURE p1;</span><br></pre></td></tr></table></figure>
<h3 id="17-12-存储过程查看"><a href="#17-12-存储过程查看" class="headerlink" title="17.12 存储过程查看"></a>17.12 存储过程查看</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">查看存储过程的信息</span><br><span class="line">SHOW CREATE PROCEDURE  myp2;</span><br></pre></td></tr></table></figure>
<h2 id="18-函数的介绍"><a href="#18-函数的介绍" class="headerlink" title="18. 函数的介绍"></a>18. 函数的介绍</h2><p>含义：一组预先编译好的SQL语句的集合，理解成批处理语句<br>1、提高代码的重用性<br>2、简化操作<br>3、减少了编译次数并且减少了和数据库服务器的连接次数，提高了效率</p>
<p>区别：</p>
<p>存储过程：可以有0个返回，也可以有多个返回，适合做批量插入、批量更新<br>函数：有且仅有1 个返回，适合做处理数据后返回一个结果</p>
<h3 id="18-1-函数的创建和调用语法"><a href="#18-1-函数的创建和调用语法" class="headerlink" title="18.1 函数的创建和调用语法"></a>18.1 函数的创建和调用语法</h3><ol>
<li><p>创建语法</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CREATE FUNCTION 函数名(参数列表) RETURNS 返回类型</span><br><span class="line">BEGIN</span><br><span class="line">	函数体</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">⚠️</span><br><span class="line">1.参数列表包括两部分：参数名和参数类型</span><br><span class="line">2.函数体：肯定会有return语句，如果没有会报错</span><br><span class="line">    如果return语句没有放在函数体的最后也不报错，但不建议</span><br><span class="line">3.函数体中仅有一句话，则可以省略begin end</span><br><span class="line">4.使用 delimiter语句设置结束标记</span><br></pre></td></tr></table></figure></li>
<li><p>调用语法：SELECT 函数名(参数列表)</p>
</li>
<li><p>案例</p>
<ul>
<li><p>无参有返回</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">        #案例：返回公司的员工个数</span><br><span class="line">        create function myf1() returns int</span><br><span class="line">BEGIN</span><br><span class="line">DECLARE c int default 0;# 定义变量</span><br><span class="line">	select count(*) into c# 为变量赋值</span><br><span class="line">	from employees;</span><br><span class="line">	return c;</span><br><span class="line">END</span><br><span class="line">select myf1();</span><br></pre></td></tr></table></figure>
<ul>
<li><p>有参有返回</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">        #案例1：根据员工名，返回它的工资</span><br><span class="line">        create function myf2(empName varchar(20)) returns double</span><br><span class="line">BEGIN</span><br><span class="line">	set @sal&#x3D;0; # 定义了一个用户变量</span><br><span class="line">	select salary into @sal from employees where last_name &#x3D; empName;</span><br><span class="line">	return @sal;</span><br><span class="line">END</span><br><span class="line">select myf2(&#39;John&#39;);</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="18-2-函数的查看和删除"><a href="#18-2-函数的查看和删除" class="headerlink" title="18.2 函数的查看和删除"></a>18.2 函数的查看和删除</h3><p>SHOW CREATE FUNCTION myf3;<br>DROP FUNCTION myf3;</p>
<h2 id="19-流程控制结构介绍"><a href="#19-流程控制结构介绍" class="headerlink" title="19. 流程控制结构介绍"></a>19. 流程控制结构介绍</h2><p>顺序结构：程序从上往下依次执行<br>分支结构：程序从两条或多条路径中选择一条去执行<br>循环结构：程序在满足一定条件的基础上,重复执行一段代码</p>
<h3 id="19-1-分支结构—if函数"><a href="#19-1-分支结构—if函数" class="headerlink" title="19.1 分支结构—if函数"></a>19.1 分支结构—if函数</h3><p>语法：if(条件,值1，值2)<br>功能：实现双分支<br>应用在begin end中或外面<br>执行顺序：如果表达式的条件成立，则if返回值1，否则返回值2</p>
<h3 id="19-2-分支结构—case结构"><a href="#19-2-分支结构—case结构" class="headerlink" title="19.2 分支结构—case结构"></a>19.2 分支结构—case结构</h3><p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">情况1：类似于switch语句，一般用于实现等值判断</span><br><span class="line">case 变量或表达式</span><br><span class="line">when 值1 then 语句1;</span><br><span class="line">when 值2 then 语句2;</span><br><span class="line">...</span><br><span class="line">else 语句n;</span><br><span class="line">end </span><br><span class="line"></span><br><span class="line">情况2：类似于多重if语句，一般用于实现区间判断</span><br><span class="line">case </span><br><span class="line">when 条件1 then 语句1;</span><br><span class="line">when 条件2 then 语句2;</span><br><span class="line">...</span><br><span class="line">else 语句n;</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>特点：应用在begin end 中或外面</p>
<ul>
<li>可以作为表达式，嵌套在其他语句中使用，可以放在任何地方，begin end中或外面</li>
<li>可以作为独立的语句去使用，只能放在begin end中</li>
<li>如果when中的值满足或条件成立，则执行对应的then后面的语句，并且结束case</li>
<li>如果都不满足则执行else中的语句或值</li>
<li>else可以省略，如果else省略了，并且所有where条件都不满足，则返回null</li>
</ul>
<p>案例:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#案例1：创建函数，实现传入成绩，如果成绩&gt;90,返回A，如果成绩&gt;80,返回B，如果成绩&gt;60,返回C，否则返回D</span><br><span class="line">create PROCEDURE test_case(in score int)</span><br><span class="line">BEGIN</span><br><span class="line">	case </span><br><span class="line">	when score &gt;&#x3D; 90 then SELECT &#39;A&#39;;</span><br><span class="line">	when score &gt;&#x3D;80 then select &#39;B&#39;;</span><br><span class="line">	when score &gt;&#x3D;70 then select &#39;C&#39;;</span><br><span class="line">	else select  &#39;D&#39;;</span><br><span class="line">	end case;</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">call test_case(75)</span><br></pre></td></tr></table></figure>
<h3 id="19-3-分支结构—if结构"><a href="#19-3-分支结构—if结构" class="headerlink" title="19.3 分支结构—if结构"></a>19.3 分支结构—if结构</h3><p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">语法：</span><br><span class="line">if 条件1 then 语句1;</span><br><span class="line">elseif 条件2 then 语句2;</span><br><span class="line">....</span><br><span class="line">else 语句n;</span><br><span class="line">end if;</span><br><span class="line">功能：类似于多重if</span><br><span class="line"></span><br><span class="line">只能应用在begin end 中</span><br></pre></td></tr></table></figure>
<h3 id="19-4循环结构的介绍"><a href="#19-4循环结构的介绍" class="headerlink" title="19.4循环结构的介绍"></a>19.4循环结构的介绍</h3><p>分类：</p>
<ul>
<li>while:</li>
<li>loop:</li>
<li>repeat:</li>
</ul>
<p>循环控制：</p>
<ul>
<li>iterate类似于 continue，继续，结束本次循环，继续下一次</li>
<li>leave 类似于  break，跳出，结束当前所在的循环</li>
</ul>
<p>语法：</p>
<ul>
<li><p>while </p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    【标签:】while 循环条件 do</span><br><span class="line">	循环体;</span><br><span class="line">end while【标签】;</span><br><span class="line">联想：</span><br><span class="line">while(循环条件)&#123;</span><br><span class="line">	循环体;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>loop</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">标签:】loop</span><br><span class="line">	循环体;</span><br><span class="line">end loop 【标签】;</span><br><span class="line"># 可以用来模拟简单的死循环</span><br></pre></td></tr></table></figure></li>
<li><p>repeat</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">【标签：】repeat</span><br><span class="line">	循环体;</span><br><span class="line">until 结束循环的条件</span><br><span class="line">end repeat 【标签】;</span><br></pre></td></tr></table></figure>
<h3 id="19-5-循环结构演示"><a href="#19-5-循环结构演示" class="headerlink" title="19.5 循环结构演示"></a>19.5 循环结构演示</h3><p>案例：批量插入，根据次数插入到admin表中多条记录</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create PROCEDURE pro_while1(in insertcount int)</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE i int DEFAULT 1;</span><br><span class="line">	while i &lt;&#x3D; insertcount do</span><br><span class="line">		insert into admin(username,password) values(CONCAT(&#39;ceshi&#39;,i),&#39;6666&#39;);</span><br><span class="line">		set i &#x3D; i + 1;</span><br><span class="line">		END WHILE;</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">call pro_while1(10);</span><br></pre></td></tr></table></figure>

<p>案例2:批量插入，根据次数插入到admin表中多条记录，如果次数&gt;20则停止（添加leave语句）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">create PROCEDURE pro_while2(in insertcount int)</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE i int DEFAULT 1;</span><br><span class="line">	a:while i &lt;&#x3D; insertcount do</span><br><span class="line">		insert into admin(username,password) values(CONCAT(&#39;xiaohua&#39;,i),&#39;6666&#39;);</span><br><span class="line">		if i&gt;&#x3D;20 then leave a;</span><br><span class="line">		end if;</span><br><span class="line">		set i &#x3D; i + 1;</span><br><span class="line">		END WHILE a;</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">call pro_while2(30);</span><br></pre></td></tr></table></figure>
<p>案例：批量插入，根据次数插入到admin表中多条记录，只插入偶数次（添加iterate语句）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">TRUNCATE TABLE admin$</span><br><span class="line">DROP PROCEDURE test_while1$</span><br><span class="line">CREATE PROCEDURE test_while1(IN insertCount INT)</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE i INT DEFAULT 0;</span><br><span class="line">	a:WHILE i&lt;&#x3D;insertCount DO</span><br><span class="line">		SET i&#x3D;i+1;</span><br><span class="line">		IF MOD(i,2)!&#x3D;0 THEN ITERATE a;</span><br><span class="line">		END IF;</span><br><span class="line">		</span><br><span class="line">		INSERT INTO admin(username,&#96;password&#96;) VALUES(CONCAT(&#39;xiaohua&#39;,i),&#39;0000&#39;);</span><br><span class="line">		</span><br><span class="line">	END WHILE a;</span><br><span class="line">END $</span><br><span class="line">CALL test_while1(100)$</span><br></pre></td></tr></table></figure>
      
    </div>
    <div class="article-footer">
      <!--每篇文章下的版权说明-->
<blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://lwblog.xyz/posts/671486fb.html" title="MySQL学习笔记二" target="_blank" rel="external">http://lwblog.xyz/posts/671486fb.html</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>
<!--每篇文章最底部的个人信息说明-->


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/wangyufei123" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpeg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/wangyufei123" target="_blank"><span class="text-dark">Mr.Wang</span><small class="ml-1x">Web Developer &amp; Designer</small></a></h3>
        <div>一个热爱生活的小开发....</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
    <!--上一篇或者是下一篇的位置-->
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/posts/undefined.html" title="Centos7下静默安装Oracle 11g"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/posts/f2612c14.html" title="MySQL高级部分学习一"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
  </ul>
  
  
  <!--捐赠信息是否需要显示的图标-->
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
  


</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/wangyufei123" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

	<!-- 侧边栏版权问题修改 -->
    <div class="copyright">
    	
        &copy; 2020 Mr.Wang
        
        <!-- 页面侧边栏脚标修改 -->
        <div class="publishby">
        	Theme by <a href="https://github.com/wangyufei123" target="_blank"> 随笔小记 </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: 'a1SlXAotYrikeQEkob4dUwEO-gzGzoHsz',
    appKey: 'A9wmspkpn043w1kJDU9CEXgt',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: false
  });
  </script>

     



  <script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.js"></script>
  <script>
  //利用 FancyBox 实现点击图片放大
  $(document).ready(function() {
    $('article img').not('[hidden]').not('.panel-body img').each(function() {
      var $image = $(this);
      var imageCaption = $image.attr('alt');
      var $imageWrapLink = $image.parent('a');
      if ($imageWrapLink.length < 1) {
        var src = this.getAttribute('src');
        var idx = src.lastIndexOf('?');
        if (idx != -1) {
          src = src.substring(0, idx);
        }
        $imageWrapLink = $image.wrap('<a href="' + src + '"></a>').parent('a');
      }
      $imageWrapLink.attr('data-fancybox', 'images');
      if (imageCaption) {
        $imageWrapLink.attr('data-caption', imageCaption);
      }
    });
    $().fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
    });
  });
  </script>





</body>
<!--背景3D动画-->
<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
<!--点击出现小爱心-->
<script type="text/javascript" src="//cdn.jsdelivr.net/gh/ygbhf/clicklove/clicklove.js"></script>
<!-- 代码块复制功能 -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@1/dist/clipboard.min.js"></script>
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<!-- <script type="text/javascript" src="/js/clipboard.js"></script>  -->
<script type="text/javascript" src="/js/clipboard_use.js"></script>
</html>